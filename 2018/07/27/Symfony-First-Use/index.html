<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>symfony 框架初次使用 | Keep It Simple And Stupid</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="Symfony">
  
  
  
  
  <meta name="description" content="Symfony 框架的中文翻译是交响乐, 而Composer的中文翻译是作曲家, 这就让我非常有兴趣去学习一波Symfony 中文文档">
<meta name="keywords" content="Symfony">
<meta property="og:type" content="article">
<meta property="og:title" content="Symfony 框架初次使用">
<meta property="og:url" content="http://blog.caoxl.com/2018/07/27/Symfony-First-Use/index.html">
<meta property="og:site_name" content="Keep It Simple And Stupid">
<meta property="og:description" content="Symfony 框架的中文翻译是交响乐, 而Composer的中文翻译是作曲家, 这就让我非常有兴趣去学习一波Symfony 中文文档">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-08-22T06:41:47.178Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Symfony 框架初次使用">
<meta name="twitter:description" content="Symfony 框架的中文翻译是交响乐, 而Composer的中文翻译是作曲家, 这就让我非常有兴趣去学习一波Symfony 中文文档">
  
    <link rel="alternate" href="/atom.xml" title="Keep It Simple And Stupid" type="application/atom+xml">
  

  

  <link rel="icon" href="http://caoxl.com/imgs/we-min.jpg">
  <link rel="apple-touch-icon" href="/http://caoxl.com/imgs/we-min.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>
  <script src="/js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">

  
    <link rel="stylesheet" href="/css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css">
  

  
  
  

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="124px" height="124px" alt="Hike News" src="http://caoxl.com/imgs/we-min.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">首页</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">归档</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">分类</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">标签</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">关于</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-Symfony-First-Use" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      Symfony 框架初次使用
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/07/27/Symfony-First-Use/" class="article-date">
	  <time datetime="2018-07-27T08:51:14.000Z" itemprop="datePublished">2018-07-27</time>
	</a>

      
    <a class="article-category-link" href="/categories/框架相关/">框架相关</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		阅读量<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

    </div>

    <div class="article-entry" itemprop="articleBody">
      
        
        
          <blockquote>
<p><code>Symfony</code> 框架的中文翻译是<strong>交响乐</strong>, 而<code>Composer</code>的中文翻译是<strong>作曲家</strong>, 这就让我非常有兴趣去学习一波<br><a href="http://www.symfonychina.com/doc/current/setup.html" target="_blank" rel="noopener">Symfony 中文文档</a></p>
</blockquote>
<a id="more"></a>
<h1 id="安装-Symfony-Installer"><a href="#安装-Symfony-Installer" class="headerlink" title="安装 Symfony Installer"></a>安装 <code>Symfony Installer</code></h1><h2 id="Linux和MAC-OS-X系统"><a href="#Linux和MAC-OS-X系统" class="headerlink" title="Linux和MAC OS X系统"></a><code>Linux</code>和<code>MAC OS X</code>系统</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -LsS <span class="string">https:</span><span class="comment">//symfony.com/installer -o /usr/local/bin/symfony</span></span><br><span class="line"></span><br><span class="line">sudo chmod a+x <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>symfony</span><br></pre></td></tr></table></figure>
<h2 id="Windows系统"><a href="#Windows系统" class="headerlink" title="Windows系统"></a><code>Windows</code>系统</h2><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">c:</span>\&gt; php -r <span class="string">"readfile('http://symfony.com/installer');"</span> &gt; symfony</span><br></pre></td></tr></table></figure>
<p>它会下载一个<code>symfony</code>文件，然后把这文件移动到你想创建<code>Symfony</code>项目的文件夹里，通过下述命令可引导各种安装</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c:<span class="symbol">\&gt;</span> move symfony c:<span class="symbol">\p</span>rojects</span><br><span class="line">c:<span class="symbol">\p</span>rojects<span class="symbol">\&gt;</span> php symfony</span><br></pre></td></tr></table></figure>
<blockquote>
<p>略略略, 直接进入<code>Composer</code></p>
</blockquote>
<h2 id="用Composer创建Symfony程序"><a href="#用Composer创建Symfony程序" class="headerlink" title="用Composer创建Symfony程序"></a>用<code>Composer</code>创建<code>Symfony</code>程序</h2><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">composer </span><span class="built_in">create-project</span> <span class="string">symfony/</span><span class="string">framework-standard-</span><span class="string">edition </span><span class="string">my_project_name</span></span><br></pre></td></tr></table></figure>
<ul>
<li>若需指定版本，提供版本号作为<code>create-project</code>的第二个参数</li>
</ul>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">composer </span><span class="built_in">create-project</span> <span class="string">symfony/</span><span class="string">framework-standard-</span><span class="string">edition </span><span class="string">my_project_name </span><span class="string">"3.0.*"</span></span><br></pre></td></tr></table></figure>
<h1 id="运行Symfony"><a href="#运行Symfony" class="headerlink" title="运行Symfony"></a>运行<code>Symfony</code></h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php ./bin<span class="built_in">/console </span>server:run</span><br></pre></td></tr></table></figure>
<p>然后，打开浏览器访问<code>http://localhost:8000/</code>链接，即可看到<code>Symfony</code>欢迎页</p>
<h1 id="创建一个页面"><a href="#创建一个页面" class="headerlink" title="创建一个页面"></a>创建一个页面</h1><h2 id="路由和控制器"><a href="#路由和控制器" class="headerlink" title="路由和控制器"></a>路由和控制器</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Response</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">JsonResponse</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">LuckyController</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @return Response</span><br><span class="line">     * @Route("/lucky/number")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandNumber</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $num = rand(<span class="number">1</span>, <span class="number">100</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">new</span> Response(</span></span><br><span class="line"><span class="php">            <span class="string">'&lt;html&gt;&lt;body&gt;number: '</span> . $num . <span class="string">'&lt;/body&gt;&lt;/html&gt;'</span></span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>访问 <a href="http://localhost:8000/lucky/number" target="_blank" rel="noopener">http://localhost:8000/lucky/number</a></p>
</blockquote>
<h2 id="路由在哪里"><a href="#路由在哪里" class="headerlink" title="路由在哪里 ?"></a>路由在哪里 ?</h2><blockquote>
<p>路由写在注释里, 真的是长见识了, Symfony的路由居然是在注释里面</p>
<blockquote>
<p><code>@Route(&quot;/lucky/number&quot;)</code><br><code>@Route</code>被称为<code>annotation</code>，它定义了<code>URL</code>匹配</p>
</blockquote>
</blockquote>
<h2 id="创建一个JSON响应"><a href="#创建一个JSON响应" class="headerlink" title="创建一个JSON响应"></a>创建一个<code>JSON</code>响应</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">LuckyController</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @return Response</span><br><span class="line">     * @Route("/api/lucky/number2")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandNumberApi</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $data = <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">            <span class="string">'lucky_number'</span> =&gt; rand(<span class="number">0</span>, <span class="number">100</span>),</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">new</span> Response(</span></span><br><span class="line"><span class="php">            json_encode($data),</span></span><br><span class="line"><span class="php">            <span class="number">200</span>,</span></span><br><span class="line"><span class="php">            <span class="keyword">array</span>(<span class="string">'Content-Type'</span> =&gt; <span class="string">'application/json'</span>)</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>访问: <code>http://localhost:8000/api/lucky/number2</code></p>
</blockquote>
<p><strong>你更可将代码精简为超好用的<code>JsonResponse</code>:</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="comment">// 使用JSONResponse需要引入下面这个声明</span></span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">JsonResponse</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">LuckyController</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @return Response</span><br><span class="line">     * @Route("/api/lucky/number2")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandNumberApi</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $data = <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">            <span class="string">'lucky_number'</span> =&gt; rand(<span class="number">0</span>, <span class="number">100</span>),</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php">        </span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">new</span> JsonResponse($data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="动态URL匹配-lucky-number-count"><a href="#动态URL匹配-lucky-number-count" class="headerlink" title="动态URL匹配: /lucky/number/{count}"></a>动态URL匹配: <code>/lucky/number/{count}</code></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $count</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Response</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Route</span>("/lucky/number3/&#123;count&#125;")</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandNumberCount</span><span class="params">($count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $numbers = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count; $i++) &#123;</span><br><span class="line">        $numbers[] = rand(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $numbersList = implode(<span class="string">','</span>, $numbers);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Response(</span><br><span class="line">        <span class="string">'&lt;html&gt;&lt;body&gt;Lucky numbers: '</span>.$numbersList.<span class="string">'&lt;/body&gt;&lt;/html&gt;'</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>因为<code>{count}</code>占位符，页面<code>URL</code>变得不一样了。现在它要求<code>URLs</code>匹配<code>/lucky/number/*</code></p>
</blockquote>
<blockquote>
<p>访问: <code>http://localhost:8000/lucky/number3/7</code></p>
</blockquote>
<h2 id="渲染模板-利用容器"><a href="#渲染模板-利用容器" class="headerlink" title="渲染模板 (利用容器)"></a>渲染模板 (利用容器)</h2><blockquote>
<p>如果你在控制器中返回HTML，你可能需要渲染模板。幸运的是，<strong>Symfony拥有Twig</strong></p>
</blockquote>
<blockquote>
<p>目前，<code>LuckyController</code>没有继承任何基类。此时引用<code>Twig</code>（或其他Symfony工具）最简单的方式，就是继承<code>Symfony</code>的<code>Controller</code>基类</p>
</blockquote>
<ul>
<li><code>Controller</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $count</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Response</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Route</span>("/lucky/number4/&#123;count&#125;")</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandNumberTwig</span><span class="params">($count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $numbers = <span class="keyword">array</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count; $i++) &#123;</span><br><span class="line">        $numbers[] = rand(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $numbersList = implode(<span class="string">','</span>, $numbers);</span><br><span class="line">    </span><br><span class="line">    $html = <span class="keyword">$this</span>-&gt;render(</span><br><span class="line">        <span class="string">'lucky/number.html.twig'</span>,</span><br><span class="line">        <span class="keyword">array</span>(<span class="string">'luckyNumberList'</span> =&gt; $numbersList)</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Response($html);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Twig</code></li>
</ul>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#123;# app/Resources/views/lucky/number.html.twig #&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">extends</span></span>'base.html.twig' %&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> body %&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Lucky Numbers: </span><span class="template-variable">&#123;&#123; luckyNumberList &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endblock</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<p>访问: <code>http://localhost:8000/lucky/number4/7</code></p>
</blockquote>
</blockquote>
<h1 id="Symfony-目录结构"><a href="#Symfony-目录结构" class="headerlink" title="Symfony 目录结构"></a><code>Symfony</code> 目录结构</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">├─app</span><br><span class="line">│  ├─config</span><br><span class="line">│  └─Resources</span><br><span class="line">│      └─views</span><br><span class="line">│          ├─<span class="keyword">default</span></span><br><span class="line">├─bin</span><br><span class="line">│  ├─<span class="built_in">console</span></span><br><span class="line">│  └─symfony_requirements</span><br><span class="line">├─src</span><br><span class="line">│  └─AppBundle</span><br><span class="line">│      └─Controller</span><br><span class="line">├─tests</span><br><span class="line">│  └─AppBundle</span><br><span class="line">│      └─Controller</span><br><span class="line">├─<span class="keyword">var</span></span><br><span class="line">├─vendor</span><br><span class="line">└─web</span><br></pre></td></tr></table></figure>
<h2 id="app"><a href="#app" class="headerlink" title="app/"></a><code>app/</code></h2><blockquote>
<p>内含配置文件和模板. 大体上, 只要不是PHP代码的材料都放在这里</p>
</blockquote>
<h2 id="bin"><a href="#bin" class="headerlink" title="bin/"></a><code>bin/</code></h2><blockquote>
<p>用于存放二进制（binary）文件。最重要的是<code>console</code>文件，它被用来在<code>console</code>中执行<code>Symfony</code>命令。</p>
<blockquote>
<p>php ./bin/console server:run </p>
</blockquote>
</blockquote>
<h2 id="src"><a href="#src" class="headerlink" title="src/"></a><code>src/</code></h2><blockquote>
<p>你的PHP程序之所在</p>
</blockquote>
<p><code>src/</code>目录下暂时只有一个目录 - <code>src/AppBundle</code> - 所有的东西都在这里面</p>
<h2 id="test"><a href="#test" class="headerlink" title="test/"></a><code>test/</code></h2><blockquote>
<p>你程序的自动测试（如<code>Unit tests</code>/<code>单元测试</code>）被存放在这里。</p>
</blockquote>
<h2 id="var"><a href="#var" class="headerlink" title="var/"></a><code>var/</code></h2><blockquote>
<p>这是那些自动生成的文件被存放的地方，比如缓存文件 (<code>var/cache/</code>) 和日志文件(<code>var/logs/</code>)</p>
</blockquote>
<h2 id="vendor"><a href="#vendor" class="headerlink" title="vendor/"></a><code>vendor/</code></h2><blockquote>
<p>通过依赖管理器<code>Composer</code>，第三方类库、包、<code>bundles</code>被下载到这里。你应该不去编辑这个目录下的东西。</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web/"></a><code>web/</code></h2><blockquote>
<p>它是整个项目的文档根目录，存放可公开访问的文件，比如<code>CSS</code>、图片以及用来执行app（<code>app_dev.php</code>和<code>app.php</code>）的<code>Symfony</code>的前端控制器（<code>front controller</code>）。</p>
</blockquote>
<h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><h2 id="路由实例"><a href="#路由实例" class="headerlink" title="路由实例"></a>路由实例</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @Route("/blog", name="blog_list")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @param $slug</span><br><span class="line">     * @Route("/blog/&#123;slug&#125;", name="blog_show")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">($slug)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="添加-通配符-条件"><a href="#添加-通配符-条件" class="headerlink" title="添加{通配符}条件"></a>添加{通配符}条件</h2><blockquote>
<p>设想 <code>blog_list</code> 路由将包含博客主题带有分页的一个列表，对于第2和第3页有类似 <code>/blog/2</code> 和 <code>/blog/3</code> 这样的URL。如果你把路由路径改为 <code>/blog/{page}</code>，会出现问题:</p>
</blockquote>
<ul>
<li><code>blog_list</code>: <code>/blog/{page}</code> 将匹配 <code>/blog/*</code>;</li>
<li><code>blog_show</code>: <code>/blog/{slug}</code> 将 同样 匹配 <code>/blog/*</code>。</li>
</ul>
<p><strong>于是:</strong></p>
<blockquote>
<p>要修复这个，添加一个 <code>requirement</code>（条件），以便 <code>{page}</code> 通配符能够 仅 匹配数字(digits):</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @Route("/blog", name="blog_list", requirements=&#123;"page": "\d+"&#125;)</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @param $slug</span><br><span class="line">     * @Route("/blog/&#123;slug&#125;", name="blog_show")</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">($slug)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="给-占位符-一个默认值"><a href="#给-占位符-一个默认值" class="headerlink" title="给{占位符}一个默认值"></a>给{占位符}一个默认值</h2><blockquote>
<p>前例中，<code>blog_list</code> 路由的路径是 <code>/blog/{page}</code>。如果用户访问 <code>/blog/1</code>，则会匹配。但如果他们访问的是 <code>/blog</code>，就将 无法 匹配到。一旦你添加了某个 {占位符} 到路由中，它就 必须 得有一个值</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @Route("/blog", name="blog_list", requirements=&#123;"page": "\d+"&#125;)</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span><span class="params">($page = <span class="number">1</span>)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>现在，当用户访问 <code>/blog</code> 时，<code>blog_list</code> 路由会匹配，并且 <code>$page</code> 路由参数会默认取值为 <code>1</code>。</p>
</blockquote>
<h3 id="高级路由示例"><a href="#高级路由示例" class="headerlink" title="高级路由示例"></a>高级路由示例</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line">    /**</span><br><span class="line">     * @param $_locale</span><br><span class="line">     * @param $year</span><br><span class="line">     * @param $slug</span><br><span class="line">     * @Route(</span><br><span class="line">     *     "/article/&#123;_locale&#125;/&#123;year&#125;/&#123;slug&#125;.&#123;_format&#125;",</span><br><span class="line">     *     defaults=&#123;"_format": "html"&#125;,</span><br><span class="line">     *     requirements=&#123;</span><br><span class="line">     *          "_locale": "en|fr",</span><br><span class="line">     *          "_format": "html|rss",</span><br><span class="line">     *          "year": "\d+"</span><br><span class="line">     *     &#125;</span><br><span class="line">     * )</span><br><span class="line"><span class="php">     */</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">($_locale, $year, $slug)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<p>如你所见，这个路由仅在<code>URL</code>的 <code>{_locale}</code> 部分是 <code>en</code> 或 <code>fr</code> 时，同时 <code>{year}</code> 是一个数字的时候，才会匹配。此路由也表明，你可以在占位符之间使用一个“点”而不是一个斜杠。匹配这个路由的URL可能是下面这种：</p>
<ul>
<li><code>/articles/en/2018/my-post</code></li>
<li><code>/articles/fr/2018/my-post.rss</code></li>
<li><code>/articles/en/2018/my-latest-post.html</code></li>
</ul>
<blockquote>
<p>!!! 一个路由占位符名称不可以起于数字，也不可以长于32个字符。</p>
</blockquote>
<h3 id="特殊路由参数"><a href="#特殊路由参数" class="headerlink" title="特殊路由参数"></a>特殊路由参数</h3><p>你已经看到，每一个路由参数或其默认值最终都是可以做为参数（<code>arguments</code>）用在控制器方法（译注：即<code>action</code>）中的。此外，还有四个特殊参数：每一个都能为你的程序增添一个独有的功能性。</p>
<ul>
<li><code>_controller</code>: 就像你看到的, 此参数用于决定, 当路由匹配时, 须执行哪个控制器</li>
<li><code>_format</code>: 用于设置<code>request format</code></li>
<li><code>_fragment</code>: 用于设置<code>fragment identifier</code>，即，<code>URL</code>中可选的最末部分，起自一个 # 字符，用来识别页面中的某一部分。</li>
<li><code>_locale</code>: 用于设置请求中的<code>locale</code>信息</li>
</ul>
<h2 id="控制器命名法"><a href="#控制器命名法" class="headerlink" title="控制器命名法"></a>控制器命名法</h2><blockquote>
<p>bundle:controller:action</p>
</blockquote>
<p>例如，<code>AppBundle:Blog:show</code> 这个 <code>_controller</code> 值代表:</p>
<ul>
<li><code>Bundle (Bundle名)</code> - <code>AppBundle</code></li>
<li><code>Controller Class (控制器类名)</code> - <code>BlogController</code></li>
<li><code>Method Name (控制器方法名)</code> - <code>showAction</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">($slug)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="加载路由"><a href="#加载路由" class="headerlink" title="加载路由"></a>加载路由</h2><blockquote>
<p><code>Symfony</code> 从一个 单一的 路由配置文件: <code>app/config/routing.yml</code>中加载你的程序中的全部路由<br>但从这个文件中，你可以加载任何一个 其他的 路由文件。实际上，<code>Symfony</code>默认从你 <code>AppBundle</code> 中的 <code>Controller/</code> 目录中加载<code>annotation</code>路由配置，这就是为何<code>Symfony</code>能够看到我们的<code>annotation</code>路由:</p>
</blockquote>
<ul>
<li><code>app\config\routing.yml</code></li>
</ul>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">app:</span></span><br><span class="line">    <span class="symbol">resource:</span> <span class="string">'@AppBundle/Controller/'</span></span><br><span class="line">    <span class="symbol">type:</span> <span class="keyword">annotation</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>annotation</code>: 注释的意思</p>
</blockquote>
<h2 id="生成URL"><a href="#生成URL" class="headerlink" title="生成URL"></a>生成<code>URL</code></h2><p>路由系统也可用来生成<code>URL</code>链接。现实中，路由是个双向系统：<strong>把URL映射到控制器，或把路由反解为URL</strong>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $slug</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Route</span>("/blog/&#123;slug&#125;", name="blog_show")</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showAction</span><span class="params">($slug)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $url = <span class="keyword">$this</span>-&gt;generateUrl(</span><br><span class="line">        <span class="string">'blog_show'</span>,</span><br><span class="line">        <span class="keyword">array</span>(<span class="string">'slug'</span> =&gt; <span class="string">'my-blog-post'</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>generateUrl()</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">generateUrl</span><span class="params">($route, $parameters = array<span class="params">()</span>, $referenceType = UrlGeneratorInterface::ABSOLUTE_PATH)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;container-&gt;get(<span class="string">'router'</span>)-&gt;generate($route, $parameters, $referenceType);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>定义在 <code>Controller</code> 基类中的 <code>generateUrl()</code> 方法是以下代码的快捷方式:</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$url = $<span class="keyword">this</span>-&gt;container-&gt;get<span class="function"><span class="params">(<span class="string">'router'</span>)</span>-&gt;</span>generate(</span><br><span class="line">    <span class="string">'blog_show'</span>,</span><br><span class="line">    array(<span class="string">'slug'</span> =&gt; <span class="string">'my-blog-post'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="生成带有Query字符串的URL"><a href="#生成带有Query字符串的URL" class="headerlink" title="生成带有Query字符串的URL"></a>生成带有<code>Query</code>字符串的<code>URL</code></h3><blockquote>
<p><code>generate()</code> 方法接收通配符的值的数组，以生成URI。但如果你传入额外的值，它们将被添加到<code>URI</code>中，作为<code>query string</code>（查询字符串）:</p>
</blockquote>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">this</span>-&gt;get<span class="function"><span class="params">(<span class="string">'router'</span>)</span>-&gt;</span>generate(<span class="string">'blog'</span>, array(</span><br><span class="line">    <span class="string">'page'</span> =&gt; <span class="number">2</span>,</span><br><span class="line">    <span class="string">'category'</span> =&gt; <span class="string">'Symfony'</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure>
<h3 id="生成绝对URL"><a href="#生成绝对URL" class="headerlink" title="生成绝对URL"></a>生成绝对<code>URL</code></h3><blockquote>
<p>默认时，路由生成相对链接 (如 <code>/blog</code>)。在控制器中把 <code>UrlGeneratorInterface::ABSOLUTE_URL</code> 作为 <code>generateUrl()</code> 方法的第三个参数传入:</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Generator</span>\<span class="title">UrlGeneratorInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;gengerateUrl(<span class="string">'blog_show'</span>, <span class="keyword">array</span>(<span class="string">'slug'</span> =&gt; <span class="string">'my-blog-post'</span>), UrlGeneratorInterface::ABSOLUTE_URL)</span><br></pre></td></tr></table></figure>
<h1 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h1><h2 id="基础控制器"><a href="#基础控制器" class="headerlink" title="基础控制器"></a>基础控制器</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Response</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Sensio</span>\<span class="title">Bundle</span>\<span class="title">FrameworkExtraBundle</span>\<span class="title">Configuration</span>\<span class="title">Route</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">TestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span><span class="params">($name)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">new</span> Response(<span class="string">'&lt;html&gt;&lt;body&gt;Hello '</span>.$name.<span class="string">'!&lt;/body&gt;&lt;/html&gt;'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirectToRoute(<span class="string">'homepage'</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirectToRoute(<span class="string">'homepage'</span>, <span class="keyword">array</span>(), <span class="number">301</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="渲染模板"><a href="#渲染模板" class="headerlink" title="渲染模板"></a>渲染模板</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'default/index.html.twig'</span>, <span class="keyword">array</span>(<span class="string">'name'</span> =&gt; $name));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="访问其他服务"><a href="#访问其他服务" class="headerlink" title="访问其他服务"></a>访问其他服务</h2><p>当继承<code>controller</code>基类后，你可以通过<code>get()</code>方法访问任何<code>Symfony</code>的服务。下面列举了一些常见服务：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$templating</span> = <span class="variable">$this</span>-&gt;<span class="builtin-name">get</span>(<span class="string">'templating'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$router</span> = <span class="variable">$this</span>-&gt;<span class="builtin-name">get</span>(<span class="string">'router'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$mailer</span> = <span class="variable">$this</span>-&gt;<span class="builtin-name">get</span>(<span class="string">'mailer'</span>);</span><br></pre></td></tr></table></figure>
<p><strong>问</strong>: 到底存在哪些服务？我想要看所有的服务，请使用<code>debug:container</code>命令行查看：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php bin<span class="built_in">/console </span>debug:container</span><br></pre></td></tr></table></figure>
<h2 id="Request对象作为一个控制器参数"><a href="#Request对象作为一个控制器参数" class="headerlink" title="Request对象作为一个控制器参数"></a><code>Request</code>对象作为一个控制器参数</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span><span class="params">($firstName, $lastName, Request $request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $page = $request-&gt;query-&gt;get(<span class="string">'page'</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="管理Session"><a href="#管理Session" class="headerlink" title="管理Session"></a>管理<code>Session</code></h2><blockquote>
<p><code>Symfony</code>提供了一个好用的<code>Session</code>对象，它能够存储有关用户的信息（它可以是使用浏览器的人、<code>bot</code>或<code>Web</code>服务）之间的请求。默认情况下，<code>Symfony</code>通过使用<code>PHP</code>的原生<code>Session</code>来保存<code>cookie</code>中的属性。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">AppBundle</span>\<span class="title">Controller</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Session</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span><span class="params">(Request $request)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $session = $request-&gt;getSession();</span></span><br><span class="line"></span><br><span class="line"><span class="php">        $session-&gt;set(<span class="string">'foo'</span>, <span class="string">'bar'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">        $fooBar = $session-&gt;get(<span class="string">'foobar'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">        $filters = $session-&gt;get(<span class="string">'filters'</span>, <span class="keyword">array</span>());</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="请求和响应对象"><a href="#请求和响应对象" class="headerlink" title="请求和响应对象"></a>请求和响应对象</h2><p>正如前面所提到的，框架的<code>Request</code>对象会作为控制器的参数传入并强制指定数据类型为<code>Request</code>类：</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public function indexList(Request $request)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// is Ajax request ?</span></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span>isXmlHttpRequest();</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span>getPreferredLanguage(<span class="string">'en'</span>, <span class="string">'fr'</span>);</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">query</span>-&gt;</span>get(<span class="string">'page'</span>);</span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">request</span>-&gt;</span>get(<span class="string">'page'</span>);</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">server</span>-&gt;</span>get(<span class="string">'HTTP_HOST'</span>);</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">files</span>-&gt;</span>get(<span class="string">'foo'</span>);</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">cookies</span>-&gt;</span>get(<span class="string">'PHPSESSID'</span>);</span><br><span class="line"></span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">headers</span>-&gt;</span>get(<span class="string">'host'</span>);</span><br><span class="line">    $<span class="function"><span class="title">request</span>-&gt;</span><span class="function"><span class="title">headers</span>-&gt;</span>get(<span class="string">'content_type'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><blockquote>
<p><code>Symfony</code>程序是由一组“负责呈现全部功能和可能性”的<code>bundles</code>所构成。每个<code>bundle</code>都可以通过<code>YAML</code>、<code>XML</code>或<code>PHP</code>格式的配置文件进行自定义</p>
</blockquote>
<blockquote>
<p>默认的主力配置文件是在<code>app/config</code>/目录下，它可以是<code>config.yml</code>、<code>config.xml</code>或<code>config.php</code>，根据你的偏好而定：</p>
</blockquote>
<h2 id="配置示例"><a href="#配置示例" class="headerlink" title="配置示例"></a>配置示例</h2><h3 id="YAML"><a href="#YAML" class="headerlink" title="YAML"></a><code>YAML</code></h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># app/config/config.yml</span></span><br><span class="line"><span class="symbol">imports:</span></span><br><span class="line">    - &#123; resource: parameters.yml &#125;</span><br><span class="line">    - &#123; resource: security.yml &#125;</span><br><span class="line"></span><br><span class="line"><span class="symbol">framework:</span></span><br><span class="line"><span class="symbol">    secret:</span>          <span class="string">"%secret%"</span></span><br><span class="line"><span class="symbol">    router:</span>          &#123; resource: <span class="string">"%kernel.root_dir%/config/routing.yml"</span> &#125;</span><br><span class="line">    <span class="meta"># ...</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># Twig Configuration</span></span><br><span class="line"><span class="symbol">twig:</span></span><br><span class="line"><span class="symbol">    debug:</span>            <span class="string">"%kernel.debug%"</span></span><br><span class="line"><span class="symbol">    strict_variables:</span> <span class="string">"%kernel.debug%"</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># ...</span></span><br></pre></td></tr></table></figure>
<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a><code>XML</code></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app/config/config.xml --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">container</span> <span class="attr">xmlns</span>=<span class="string">"http://symfony.com/schema/dic/services"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:framework</span>=<span class="string">"http://symfony.com/schema/dic/symfony"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:twig</span>=<span class="string">"http://symfony.com/schema/dic/twig"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://symfony.com/schema/dic/services</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://symfony.com/schema/dic/services/services-1.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://symfony.com/schema/dic/symfony</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://symfony.com/schema/dic/symfony/symfony-1.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://symfony.com/schema/dic/twig</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://symfony.com/schema/dic/twig/twig-1.0.xsd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">imports</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"parameters.yml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"security.yml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">imports</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">framework:config</span> <span class="attr">secret</span>=<span class="string">"%secret%"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">framework:router</span> <span class="attr">resource</span>=<span class="string">"%kernel.root_dir%/config/routing.xml"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">framework:config</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Twig Configuration --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">twig:config</span> <span class="attr">debug</span>=<span class="string">"%kernel.debug%"</span> <span class="attr">strict-variables</span>=<span class="string">"%kernel.debug%"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">container</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a><code>PHP</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/config/config.php</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;import(<span class="string">'parameters.yml'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;import(<span class="string">'security.yml'</span>);</span><br><span class="line"> </span><br><span class="line">$container-&gt;loadFromExtension(<span class="string">'framework'</span>, <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'secret'</span> =&gt; <span class="string">'%secret%'</span>,</span><br><span class="line">    <span class="string">'router'</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'resource'</span> =&gt; <span class="string">'%kernel.root_dir%/config/routing.php'</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Twig Configuration</span></span><br><span class="line">$container-&gt;loadFromExtension(<span class="string">'twig'</span>, <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'debug'</span>            =&gt; <span class="string">'%kernel.debug%'</span>,</span><br><span class="line">    <span class="string">'strict_variables'</span> =&gt; <span class="string">'%kernel.debug%'</span>,</span><br><span class="line">));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><ul>
<li><code>AppKernel</code>类负责加载你指定的配置文件：</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">registerContainerConfiguration</span><span class="params">(LoaderInterface $loader)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $loader-&gt;load(<span class="function"><span class="keyword">function</span> <span class="params">(ContainerBuilder $container)</span> </span>&#123;</span><br><span class="line">        $container-&gt;setParameter(<span class="string">'container.autowiring.strict_mode'</span>, <span class="keyword">true</span>);</span><br><span class="line">        $container-&gt;setParameter(<span class="string">'container.dumper.inline_class_loader'</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        $container-&gt;addObjectResource(<span class="keyword">$this</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    $loader-&gt;load(<span class="keyword">$this</span>-&gt;getRootDir().<span class="string">'/config/config_'</span>.<span class="keyword">$this</span>-&gt;getEnvironment().<span class="string">'.yml'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

    <footer class="article-footer">
      
      
      <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>本文作者:  </strong>CAO XIAN LIANG</a>
          </li>
          <li class="post-copyright-link">
          <strong>本文链接:  </strong>
          <a href="/2018/07/27/Symfony-First-Use/" target="_blank" title="Symfony 框架初次使用">http://blog.caoxl.com/2018/07/27/Symfony-First-Use/</a>
          </li>
          <li class="post-copyright-license">
            <strong>版权声明:   </strong>
            本博客所有文章除特别声明外，均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            许可协议。转载请注明出处
          </li>
         
        </ul>
<div>

      
      
      
      
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Symfony/">Symfony</a></li></ul>

      

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/07/30/What-is-YAML/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          初识 YAML
        
      </div>
    </a>
  
  
    <a href="/2018/07/27/Linux-show-IP/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Linux终端查看服务器IP</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#安装-Symfony-Installer"><span class="nav-number">1.</span> <span class="nav-text">安装 Symfony Installer</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux和MAC-OS-X系统"><span class="nav-number">1.1.</span> <span class="nav-text">Linux和MAC OS X系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Windows系统"><span class="nav-number">1.2.</span> <span class="nav-text">Windows系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用Composer创建Symfony程序"><span class="nav-number">1.3.</span> <span class="nav-text">用Composer创建Symfony程序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#运行Symfony"><span class="nav-number">2.</span> <span class="nav-text">运行Symfony</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#创建一个页面"><span class="nav-number">3.</span> <span class="nav-text">创建一个页面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#路由和控制器"><span class="nav-number">3.1.</span> <span class="nav-text">路由和控制器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#路由在哪里"><span class="nav-number">3.2.</span> <span class="nav-text">路由在哪里 ?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建一个JSON响应"><span class="nav-number">3.3.</span> <span class="nav-text">创建一个JSON响应</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#动态URL匹配-lucky-number-count"><span class="nav-number">3.4.</span> <span class="nav-text">动态URL匹配: /lucky/number/{count}</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#渲染模板-利用容器"><span class="nav-number">3.5.</span> <span class="nav-text">渲染模板 (利用容器)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Symfony-目录结构"><span class="nav-number">4.</span> <span class="nav-text">Symfony 目录结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#app"><span class="nav-number">4.1.</span> <span class="nav-text">app/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bin"><span class="nav-number">4.2.</span> <span class="nav-text">bin/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#src"><span class="nav-number">4.3.</span> <span class="nav-text">src/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#test"><span class="nav-number">4.4.</span> <span class="nav-text">test/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#var"><span class="nav-number">4.5.</span> <span class="nav-text">var/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vendor"><span class="nav-number">4.6.</span> <span class="nav-text">vendor/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web"><span class="nav-number">4.7.</span> <span class="nav-text">web/</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#路由"><span class="nav-number">5.</span> <span class="nav-text">路由</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#路由实例"><span class="nav-number">5.1.</span> <span class="nav-text">路由实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加-通配符-条件"><span class="nav-number">5.2.</span> <span class="nav-text">添加{通配符}条件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#给-占位符-一个默认值"><span class="nav-number">5.3.</span> <span class="nav-text">给{占位符}一个默认值</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#高级路由示例"><span class="nav-number">5.3.1.</span> <span class="nav-text">高级路由示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#特殊路由参数"><span class="nav-number">5.3.2.</span> <span class="nav-text">特殊路由参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#控制器命名法"><span class="nav-number">5.4.</span> <span class="nav-text">控制器命名法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#加载路由"><span class="nav-number">5.5.</span> <span class="nav-text">加载路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成URL"><span class="nav-number">5.6.</span> <span class="nav-text">生成URL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#生成带有Query字符串的URL"><span class="nav-number">5.6.1.</span> <span class="nav-text">生成带有Query字符串的URL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生成绝对URL"><span class="nav-number">5.6.2.</span> <span class="nav-text">生成绝对URL</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#控制器"><span class="nav-number">6.</span> <span class="nav-text">控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础控制器"><span class="nav-number">6.1.</span> <span class="nav-text">基础控制器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重定向"><span class="nav-number">6.2.</span> <span class="nav-text">重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#渲染模板"><span class="nav-number">6.3.</span> <span class="nav-text">渲染模板</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#访问其他服务"><span class="nav-number">6.4.</span> <span class="nav-text">访问其他服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Request对象作为一个控制器参数"><span class="nav-number">6.5.</span> <span class="nav-text">Request对象作为一个控制器参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管理Session"><span class="nav-number">6.6.</span> <span class="nav-text">管理Session</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求和响应对象"><span class="nav-number">6.7.</span> <span class="nav-text">请求和响应对象</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置"><span class="nav-number">7.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#配置示例"><span class="nav-number">7.1.</span> <span class="nav-text">配置示例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#YAML"><span class="nav-number">7.1.1.</span> <span class="nav-text">YAML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML"><span class="nav-number">7.1.2.</span> <span class="nav-text">XML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP"><span class="nav-number">7.1.3.</span> <span class="nav-text">PHP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境配置"><span class="nav-number">7.2.</span> <span class="nav-text">环境配置</span></a></li></ol></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2017 - 2019 Keep It Simple And Stupid All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				访客数 : <span id="busuanzi_value_site_uv"></span> |  
				访问量 : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<script src="/js/scripts.js"></script>




  <script src="/js/dialog.js"></script>








	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Keep It Simple And Stupid
          </div>
          <div class="panel-body">
            Copyright © 2019 CAO XIAN LIANG All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>